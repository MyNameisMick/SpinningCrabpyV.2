using Unity.VisualScripting;
using UnityEngine;
using static UnityEditor.MaterialProperty;
using System.Collections;
public class RotateWashByAnim : MonoBehaviour
{
    // ????????????????
    public float currentRotationSpeed = 0f;

    // ??????????????
    public float maxRotationSpeed = 300f;

    // ??????????????????????????? (???????/??)
    public float transitionRate = 50f;

    // ???????????? (-1: ???????, 0: ????, 1: ??????????)
    [Range(-1, 1)] // ????? Slider ?? Inspector
    public int spinDirection = 0;

    // ???????????????????????
    private bool isStopped = false;
    public Animator animatorRotate;
    void Start()
    {
        // ????? Coroutine ??????????
        StartCoroutine(ControlRotationCycle());
    }

    void Update()
    {
        if (!isStopped)
        {
            // ??????????????????????????????
            float targetSpeed = spinDirection * maxRotationSpeed;

            // ????? ??????? currentRotationSpeed ??????????? targetSpeed
            currentRotationSpeed = Mathf.MoveTowards(
                currentRotationSpeed, // ???????????
                targetSpeed,          // ???????????
                transitionRate * Time.deltaTime // ???????????????????
            );
            Debug.Log("????!!");
            // ??????????????? Y ????????????????????
            transform.Rotate(Vector3.up * currentRotationSpeed * Time.deltaTime);
        }
    }

    IEnumerator ControlRotationCycle()
    {
        while (true)
        {
            // ?? 5–20 ??????
            float randomWaitTime = Random.Range(5f, 20f);
            yield return new WaitForSeconds(randomWaitTime);

            // ????????
            spinDirection = 0;
            isStopped = true;
            Debug.Log("???????");
            // ?? 3–5 ?????????????????
            float stopTime = Random.Range(3f, 5f);
            yield return new WaitForSeconds(stopTime);
            if (transitionRate <= 70 && maxRotationSpeed <= 100)
            {
                transitionRate += 3;
                maxRotationSpeed += 5;
            }

            // ??????? spinDirection -1 ???? 1
            spinDirection = Random.Range(0, 2) == 0 ? -1 : 1;
            isStopped = false;
        }
    }
}
